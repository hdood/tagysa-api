import{_ as M}from"./TextInput.c7fef562.js";import{_ as z}from"./Button.vue.25a7bc88.js";import{_ as E}from"./CropperModal.66e820c2.js";import{G,J,x as K,l as n,w as j,o as H,f as O,i as a,u as o,A as l,z as r,P as c,t as T,C as U,T as I,F as Q,K as W}from"./entry.8d13c2a4.js";import{u as X}from"./auth.f869b002.js";import"./Icon.1a64df84.js";import"./config.76ff5b5d.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./FileInput.c5e0dd43.js";import"./transition.01278a37.js";import"./micro-task.6b7d3f94.js";const Y={class:"w-full my-10"},Z={class:"flex flex-col items-center gap-4"},ee={class:"avatar"},te={class:"mask mask-squircle w-40"},se=["src"],ae={class:"text-2xl font-medium text-base-content"},oe=["onSubmit"],ne={class:"mt-4"},le={class:"text-2xl font-medium text-base-content"},re=["onSubmit"],ye={__name:"index",setup(ue){const A=G().provide.axios,f=J(),{user:$}=K(f),i=n(!1),u=n({}),b=n({}),d=n($.value.name),y=n(!1),{changePassword:N,deleteAccount:R}=X(),w=n(""),p=n(""),m=n(""),g=n(""),h=n(!1),P=n(!1),V=async()=>{if(u.value={},!d.value){u.value.name="the name files is required";return}try{y.value=!0,await A.patch(`/api/users/${$.value.id}`,{name:d.value}),await f.getUser()}catch(e){console.log(e)}y.value=!1},q=async()=>{try{await f.updateUserImage(b.value),await f.getUser(),setTimeout(()=>i.value=!1,300)}catch(e){i.value=!1,alert(e)}};j(()=>b.value,async()=>await q());async function D(){if(p.value.length<8){u.value={newPassword:["password length must be longer than 8 characters"]};return}if(p.value!=m.value){u.value={cPassword:["password confirmation is not the same as the new password"]};return}h.value=!0,await N(w.value,p.value,m.value),h.value=!1}async function F(){P.value=!0,await R(g.value)&&W().push("/"),P.value=!1}return(e,t)=>{var C,S,k,x,B;const v=M,_=z,L=E;return H(),O(Q,null,[a("div",null,[a("div",Y,[a("div",Z,[a("div",{class:"avatar",onClick:t[0]||(t[0]=s=>i.value=!0)},[a("div",ee,[a("div",te,[a("img",{src:o($).image},null,8,se)])])]),a("div",null,[a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=s=>i.value=!0)},l(e.$t("update")),1)])]),r(v,{input:o(d),"onUpdate:input":t[2]||(t[2]=s=>c(d)?d.value=s:null),label:e.$t("name"),inputType:"text",error:(C=o(u))==null?void 0:C.name},null,8,["input","label","error"]),r(_,{type:"primary",class:"mt-3",onClick:V,loading:o(y)},{default:T(()=>[U(l(e.$t("save")),1)]),_:1},8,["loading"])]),r(L,{show:o(i),onData:t[3]||(t[3]=s=>b.value=s),onClose:t[4]||(t[4]=s=>i.value=!1)},null,8,["show"]),a("h2",ae,l(e.$t("update"))+" "+l(e.$t("password")),1),a("form",{onSubmit:I(D,["prevent"])},[r(v,{input:o(w),"onUpdate:input":t[5]||(t[5]=s=>c(w)?w.value=s:null),label:e.$t("currentPassword"),inputType:"password"},null,8,["input","label"]),r(v,{input:o(p),"onUpdate:input":t[6]||(t[6]=s=>c(p)?p.value=s:null),label:e.$t("newPassword"),inputType:"password",error:(k=(S=o(u))==null?void 0:S.newPassword)==null?void 0:k[0]},null,8,["input","label","error"]),r(v,{input:o(m),"onUpdate:input":t[7]||(t[7]=s=>c(m)?m.value=s:null),label:e.$t("newPasswordConfirmation"),error:(B=(x=o(u))==null?void 0:x.cPassword)==null?void 0:B[0],inputType:"password"},null,8,["input","label","error"]),r(_,{type:"primary",class:"mt-3",loading:o(h)},{default:T(()=>[U(l(e.$t("update"))+" "+l(e.$t("password")),1)]),_:1},8,["loading"])],40,oe)]),a("div",ne,[a("h2",le,l(e.$t("delete"))+" "+l(e.$t("account")),1),a("form",{onSubmit:I(F,["prevent"])},[r(v,{input:o(g),"onUpdate:input":t[8]||(t[8]=s=>c(g)?g.value=s:null),inputType:"password",label:e.$t("password")},null,8,["input","label"]),r(_,{type:"danger",class:"mt-2",loading:o(P)},{default:T(()=>[U(l(e.$t("delete"))+" "+l(e.$t("account")),1)]),_:1},8,["loading"])],40,re)])],64)}}};export{ye as default};
