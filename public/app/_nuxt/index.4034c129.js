import{_ as M}from"./TextInput.d1c4a237.js";import{_ as z}from"./Button.vue.6778f305.js";import{_ as E}from"./CropperModal.2e61b3af.js";import{K as G,G as K,x as O,l as n,w as j,o as H,f as J,i as a,u as o,A as l,z as r,O as c,t as U,C,S as B,F as Q,I as W}from"./entry.458b6613.js";import{u as X}from"./auth.6d11e5a3.js";import"./Icon.82aece9d.js";import"./config.2982fd22.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./FileInput.009e3c70.js";import"./transition.0bced354.js";import"./micro-task.83daa364.js";const Y={class:"w-full my-10"},Z={class:"flex flex-col items-center gap-4"},ee={class:"avatar"},te={class:"mask mask-squircle w-40"},se=["src"],ae={class:"text-2xl font-medium text-base-content"},oe=["onSubmit"],ne={class:"mt-4"},le={class:"text-2xl font-medium text-base-content"},re=["onSubmit"],ye={__name:"index",setup(ue){const A=G().provide.axios,f=K(),{user:$}=O(f),i=n(!1),u=n({}),b=n({}),d=n($.value.name),y=n(!1),{changePassword:N,deleteAccount:R}=X(),w=n(""),p=n(""),m=n(""),g=n(""),h=n(!1),_=n(!1),V=async()=>{if(u.value={},!d.value){u.value.name="the name files is required";return}try{y.value=!0,await A.patch(`/api/users/${$.value.id}`,{name:d.value}),await f.getUser()}catch(e){console.log(e)}y.value=!1},q=async()=>{try{await f.updateUserImage(b.value),await f.getUser(),setTimeout(()=>i.value=!1,300)}catch(e){i.value=!1,alert(e)}};j(()=>b.value,async()=>await q());async function D(){if(p.value.length<8){u.value={newPassword:["password length must be longer than 8 characters"]};return}if(p.value!=m.value){u.value={cPassword:["password confirmation is not the same as the new password"]};return}h.value=!0,await N(w.value,p.value,m.value),h.value=!1}async function F(){_.value=!0,await R(g.value)&&W().push("/"),_.value=!1}return(e,t)=>{var S,T,k,I,x;const v=M,P=z,L=E;return H(),J(Q,null,[a("div",null,[a("div",Y,[a("div",Z,[a("div",{class:"avatar",onClick:t[0]||(t[0]=s=>i.value=!0)},[a("div",ee,[a("div",te,[a("img",{src:o($).image},null,8,se)])])]),a("div",null,[a("button",{class:"btn btn-primary",onClick:t[1]||(t[1]=s=>i.value=!0)},l(e.$t("update")),1)])]),r(v,{input:o(d),"onUpdate:input":t[2]||(t[2]=s=>c(d)?d.value=s:null),label:e.$t("name"),inputType:"text",error:(S=o(u))==null?void 0:S.name},null,8,["input","label","error"]),r(P,{type:"primary",class:"mt-3",onClick:V,loading:o(y)},{default:U(()=>[C(l(e.$t("save")),1)]),_:1},8,["loading"])]),r(L,{show:o(i),onData:t[3]||(t[3]=s=>b.value=s),onClose:t[4]||(t[4]=s=>i.value=!1)},null,8,["show"]),a("h2",ae,l(e.$t("update"))+" "+l(e.$t("password")),1),a("form",{onSubmit:B(D,["prevent"])},[r(v,{input:o(w),"onUpdate:input":t[5]||(t[5]=s=>c(w)?w.value=s:null),label:e.$t("currentPassword"),inputType:"password"},null,8,["input","label"]),r(v,{input:o(p),"onUpdate:input":t[6]||(t[6]=s=>c(p)?p.value=s:null),label:e.$t("newPassword"),inputType:"password",error:(k=(T=o(u))==null?void 0:T.newPassword)==null?void 0:k[0]},null,8,["input","label","error"]),r(v,{input:o(m),"onUpdate:input":t[7]||(t[7]=s=>c(m)?m.value=s:null),label:e.$t("newPasswordConfirmation"),error:(x=(I=o(u))==null?void 0:I.cPassword)==null?void 0:x[0],inputType:"password"},null,8,["input","label","error"]),r(P,{type:"primary",class:"mt-3",loading:o(h)},{default:U(()=>[C(l(e.$t("update"))+" "+l(e.$t("password")),1)]),_:1},8,["loading"])],40,oe)]),a("div",ne,[a("h2",le,l(e.$t("delete"))+" "+l(e.$t("account")),1),a("form",{onSubmit:B(F,["prevent"])},[r(v,{input:o(g),"onUpdate:input":t[8]||(t[8]=s=>c(g)?g.value=s:null),inputType:"password",label:e.$t("password")},null,8,["input","label"]),r(P,{type:"danger",class:"mt-2",loading:o(_)},{default:U(()=>[C(l(e.$t("delete"))+" "+l(e.$t("account")),1)]),_:1},8,["loading"])],40,re)])],64)}}};export{ye as default};
