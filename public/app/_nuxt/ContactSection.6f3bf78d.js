import{_ as U}from"./CountryCodePicker.cb79cfbb.js";import{_ as P}from"./TextInput.69b88b03.js";import{_ as $}from"./Button.vue.c5de807b.js";import{J as k,x as A,N as B,a2 as j,G as D,l as u,w as E,m as M,y as R,o as b,f as w,i as a,T as I,z as m,u as e,P as v,O as W,Q as z,A as F,D as G,t as J,C as O}from"./entry.31ce47f0.js";import{V as Q}from"./ValidateUrl.c73b707c.js";import{u as y}from"./profile.e0543e88.js";import"./Icon.b24af752.js";import"./config.58c8a7ce.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./combobox.6ab0908e.js";import"./micro-task.c8661f31.js";import"./transition.b7c2c384.js";import"./use-resolve-button-type.62e545a6.js";const q={id:"ContactsSection"},H={class:"rounded-3xl w-full bg-base-200 p-3"},K=["onSubmit"],L=a("label",{class:"label"},[a("span",{class:"label-text"},"Phone")],-1),X={class:"flex lg:flex-nowrap flex-wrap items-center w-full gap-2"},Y={class:"join"},Z={class:""},ee={key:0,class:"text-error"},te={class:"w-full flex gap-3"},oe={class:"flex gap-2 items-end"},se={class:"w-full flex gap-3"},xe={__name:"ContactSection",setup(ae){const x=k(),{activeProfile:r}=A(y()),{successNotification:g}=B(),S=j(),C=D(S).provide.axios,l=u(""),c=u(""),s=u(""),d=u(""),t=u({}),p=u(r.value.country_code?r.value.country_code:966),f=u(!1);function V(){l.value=r.value.phone,c.value=r.value.address,s.value=r.value.website,p.value=r.value.country_code,d.value=r.value.email}E(l,i=>{var o;((o=i==null?void 0:i.toString())==null?void 0:o.length)>10&&(l.value=i.toString().slice(0,10))});const N=async()=>{var i,o;if(t.value={},((i=l==null?void 0:l.value)==null?void 0:i.toString().length)<4){t.value={phone:["phone number must be 4 digits or more"]};return}if(d.value==""){t.value={email:["email value cannot be empty"]};return}if(!Q(s.value)&&s.value){t.value={website:["website field must be a valid url"]};return}!((o=s==null?void 0:s.value)!=null&&o.includes("https"))&&s.value&&(s.value="https://"+s.value);try{f.value=!0,await C.patch(`/api/profiles/contact/${r.value.id}`,{phone:l.value,address:c.value,website:s.value,country_code:p.value?p.value:91,email:d.value}),await x.getUser(),x.refreshFrame(),g("Contact info updated successfully")}catch(_){t.value=_.response.data.errors}f.value=!1};return M(()=>{y().fetchProfile(R().params.id),V()}),(i,o)=>{const _=U,h=P,T=$;return b(),w("div",q,[a("div",H,[a("form",{onSubmit:I(N,["prevent"])},[L,a("div",X,[a("div",Y,[m(_,{modelValue:e(p),"onUpdate:modelValue":o[0]||(o[0]=n=>v(p)?p.value=n:null)},null,8,["modelValue"]),a("div",null,[a("div",Z,[W(a("input",{id:"placeholder",placeholder:"Phone",maxlength:"10",class:"input input-bordered w-full max-w-xs input-primary join-item",type:"number","onUpdate:modelValue":o[1]||(o[1]=n=>v(l)?l.value=n:null),autocomplete:"off"},null,512),[[z,e(l)]])])])])]),e(t).phone?(b(),w("div",ee,F(e(t)&&e(t).phone?e(t).phone[0]:""),1)):G("",!0),a("div",te,[m(h,{placeholder:"Email",input:e(d),"onUpdate:input":o[2]||(o[2]=n=>v(d)?d.value=n:null),class:"join-item",label:"Email",inputType:"text",rounded:!0,error:e(t)&&e(t).email?e(t).email[0]:""},null,8,["input","error"])]),a("div",oe,[m(h,{placeholder:"Address",input:e(c),"onUpdate:input":o[3]||(o[3]=n=>v(c)?c.value=n:null),rounded:!0,label:"Address",inputType:"text",error:e(t)&&e(t).address?e(t).address[0]:""},null,8,["input","error"])]),a("div",se,[m(h,{placeholder:"Website",input:e(s),"onUpdate:input":o[4]||(o[4]=n=>v(s)?s.value=n:null),inputType:"text",label:"Website",rounded:!0,error:e(t)&&e(t).website?e(t).website[0]:""},null,8,["input","error"])]),m(T,{type:"primary",class:"min-w-[10rem] h-10 mt-10",loading:e(f)},{default:J(()=>[O(" Save ")]),_:1},8,["loading"])],40,K)])])}}};export{xe as default};
